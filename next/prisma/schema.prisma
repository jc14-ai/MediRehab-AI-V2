generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model account {
  account_id        Int          @id @default(autoincrement())
  role_id           Int
  username          String       @unique @db.VarChar(100)
  password          String
  registration_date DateTime     @db.Date
  roles             roles        @relation(fields: [role_id], references: [role_id], onDelete: NoAction, onUpdate: NoAction)
  admin             admin[]
  doctor            doctor[]
  patient           patient[]
  user_image        user_image[]
}

model admin {
  admin_id   Int     @id @default(autoincrement())
  account_id Int
  account    account @relation(fields: [account_id], references: [account_id], onDelete: NoAction, onUpdate: NoAction)
}

model assign {
  assign_id   Int      @id @default(autoincrement())
  exercise_id Int
  patient_id  Int
  exercise    exercise @relation(fields: [exercise_id], references: [exercise_id], onDelete: NoAction, onUpdate: NoAction)
  patient     patient  @relation(fields: [patient_id], references: [patient_id], onDelete: NoAction, onUpdate: NoAction)
  result      result[]
}

model doctor {
  doctor_id       Int               @id @default(autoincrement())
  account_id      Int
  full_name       String            @db.VarChar(100)
  birth_date      DateTime          @db.Date
  gender          gender            @default(male)
  contact         String            @unique
  email           String            @unique @db.VarChar(100)
  address         String            @db.VarChar(100)
  account         account           @relation(fields: [account_id], references: [account_id], onDelete: NoAction, onUpdate: NoAction)
  doctors_patient doctors_patient[]
}

model doctors_patient {
  doctors_patient_id Int     @id @default(autoincrement())
  doctor_id          Int
  patient_id         Int
  notes              String?
  doctor             doctor  @relation(fields: [doctor_id], references: [doctor_id], onDelete: NoAction, onUpdate: NoAction)
  patient            patient @relation(fields: [patient_id], references: [patient_id], onDelete: NoAction, onUpdate: NoAction)
}

model exercise {
  exercise_id    Int              @id @default(autoincrement())
  exercise       String           @db.VarChar(100)
  description    String
  assign         assign[]
  exercise_image exercise_image[]
}

model exercise_image {
  exercise_image_id Int      @id @default(autoincrement())
  exercise_id       Int
  image_name        String
  filepath          String
  exercise          exercise @relation(fields: [exercise_id], references: [exercise_id], onDelete: NoAction, onUpdate: NoAction)
}

model feedback {
  feedback_id Int     @id @default(autoincrement())
  result_id   Int
  feedback    String?
  result      result  @relation(fields: [result_id], references: [result_id], onDelete: NoAction, onUpdate: NoAction)
}

model patient {
  patient_id      Int               @id @default(autoincrement())
  account_id      Int
  full_name       String            @db.VarChar(100)
  birth_date      DateTime          @db.Date
  gender          gender            @default(male)
  contact         String            @unique
  email           String            @unique @db.VarChar(100)
  address         String            @db.VarChar(100)
  assign          assign[]
  doctors_patient doctors_patient[]
  account         account           @relation(fields: [account_id], references: [account_id], onDelete: NoAction, onUpdate: NoAction)
}

model result {
  result_id    Int            @id @default(autoincrement())
  assign_id    Int
  score        Decimal        @db.Decimal(5, 2)
  feedback     feedback[]
  assign       assign         @relation(fields: [assign_id], references: [assign_id], onDelete: NoAction, onUpdate: NoAction)
  result_image result_image[]
}

model result_image {
  result_image_id Int    @id @default(autoincrement())
  result_id       Int
  image_name      String
  filepath        String
  result          result @relation(fields: [result_id], references: [result_id], onDelete: NoAction, onUpdate: NoAction)
}

model roles {
  role_id Int       @id @default(autoincrement())
  role    role      @default(patient)
  account account[]
}

model user_image {
  user_image_id Int     @id @default(autoincrement())
  account_id    Int
  image_name    String
  filepath      String
  account       account @relation(fields: [account_id], references: [account_id], onDelete: NoAction, onUpdate: NoAction)
}

enum gender {
  male
  female
  other
}

enum role {
  admin
  doctor
  patient
}
